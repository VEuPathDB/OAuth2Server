
-- Accounts table
CREATE TABLE "USERACCOUNTS"."ACCOUNTS" (
  "USER_ID"       BIGINT NOT NULL ENABLE,
  "EMAIL"         VARCHAR(255) NOT NULL ENABLE,
  "PASSWD"        VARCHAR(50) NOT NULL ENABLE,
  "IS_GUEST"      BOOLEAN NOT NULL ENABLE,
  "SIGNATURE"     VARCHAR(40),
  "STABLE_ID"     VARCHAR(500),
  "REGISTER_TIME" TIMESTAMP,
  "LAST_LOGIN"    TIMESTAMP,
  CONSTRAINT "ACCOUNTS_PK" PRIMARY KEY ("USER_ID"),
  CONSTRAINT "EMAIL_UNIQ_CONSTRAINT" UNIQUE ("EMAIL")
);

-- Account_Properties table
CREATE TABLE "USERACCOUNTS"."ACCOUNT_PROPERTIES" (
  "USER_ID" BIGINT,
  "KEY"     VARCHAR(12),
  "VALUE"   VARCHAR(4000),
  CONSTRAINT "ACCOUNT_PROPERTIES_PK" PRIMARY KEY ("USER_ID", "KEY"),
  CONSTRAINT "ACCOUNT_PROPERTIES_USER_ID_FKEY" FOREIGN KEY ("USER_ID")
     REFERENCES "USERACCOUNTS.ACCOUNTS" ("USER_ID")
);

-- Guest_IDs table
CREATE TABLE "USERACCOUNTS"."GUEST_IDS" (
  "USER_ID"       BIGINT NOT NULL ENABLE,
  "CREATION_TIME" TIMESTAMP NOT NULL ENABLE,
  CONSTRAINT "GUEST_IDS_PK" PRIMARY KEY ("USER_ID")
);

-- Accounts_PKSEQ sequence
-- NOTE: Care must be taken to set the sequence start value appropriately.
--       This involves recreating the sequence with different values on
--       north and south replicated instances.
CREATE SEQUENCE "USERACCOUNTS"."ACCOUNTS_PKSEQ"
  MINVALUE 1 MAXVALUE 9999999999999999999999999999
  INCREMENT BY 10 START WITH 261307030 CACHE 20 NOORDER NOCYCLE NOKEEP GLOBAL;

  -- Permissions to these resources
GRANT SELECT ON "USERACCOUNTS"."ACCOUNTS" TO "USERACCTS_R";
GRANT SELECT ON "USERACCOUNTS"."ACCOUNTS" TO "USERACCTS_W";
GRANT INSERT ON "USERACCOUNTS"."ACCOUNTS" TO "USERACCTS_W";
GRANT UPDATE ON "USERACCOUNTS"."ACCOUNTS" TO "USERACCTS_W";
GRANT DELETE ON "USERACCOUNTS"."ACCOUNTS" TO "USERACCTS_W";
GRANT SELECT ON "USERACCOUNTS"."ACCOUNT_PROPERTIES" TO "USERACCTS_R";
GRANT SELECT ON "USERACCOUNTS"."ACCOUNT_PROPERTIES" TO "USERACCTS_W";
GRANT INSERT ON "USERACCOUNTS"."ACCOUNT_PROPERTIES" TO "USERACCTS_W";
GRANT UPDATE ON "USERACCOUNTS"."ACCOUNT_PROPERTIES" TO "USERACCTS_W";
GRANT DELETE ON "USERACCOUNTS"."ACCOUNT_PROPERTIES" TO "USERACCTS_W";
GRANT SELECT ON "USERACCOUNTS"."GUEST_IDS" TO "USERACCTS_R";
GRANT SELECT ON "USERACCOUNTS"."GUEST_IDS" TO "USERACCTS_W";
GRANT INSERT ON "USERACCOUNTS"."GUEST_IDS" TO "USERACCTS_W";
GRANT UPDATE ON "USERACCOUNTS"."GUEST_IDS" TO "USERACCTS_W";
GRANT DELETE ON "USERACCOUNTS"."GUEST_IDS" TO "USERACCTS_W";
GRANT SELECT ON "USERACCOUNTS"."ACCOUNTS_PKSEQ" TO "USERACCTS_R";
GRANT SELECT ON "USERACCOUNTS"."ACCOUNTS_PKSEQ" TO "USERACCTS_W";

